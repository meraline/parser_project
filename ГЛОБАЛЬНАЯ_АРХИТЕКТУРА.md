# 🏗️ АРХИТЕКТУРА ПРОЕКТА: Глобальное описание структуры

## 📊 ОБЩАЯ СХЕМА ПРОЕКТА

```
parser_project/                           # Корневая директория проекта
├── 🎯 УПРАВЛЕНИЕ И КОНФИГУРАЦИЯ          # Файлы управления проектом
├── 📦 ИСХОДНЫЙ КОД (src/)                # Основной код системы
├── 🔧 СКРИПТЫ (scripts/)                 # Вспомогательные скрипты
├── 📊 ДАННЫЕ (data/)                     # Хранилище данных и кэша
├── 📚 ДОКУМЕНТАЦИЯ (docs/)               # Техническая документация
├── 🧪 ТЕСТИРОВАНИЕ (tests/)              # Автоматические тесты
├── 🐳 РАЗВЕРТЫВАНИЕ (docker/)            # Контейнеризация
└── 📝 ЛОГИ (logs/)                       # Журналы выполнения
```

---

## 🎯 УПРАВЛЕНИЕ И КОНФИГУРАЦИЯ

### Файлы управления проектом
```
├── Makefile                              # 🔨 Автоматизация команд (make setup, make run)
├── setup.py                             # 📦 Конфигурация Python пакета
├── requirements.txt                      # 📋 Зависимости Python
├── pytest.ini                           # 🧪 Настройки тестирования
├── README.md                            # 📖 Основная документация
├── quick_start.sh                       # ⚡ Скрипт быстрого запуска
└── simple_menu.py                       # 🖱️ Интерактивное меню
```

### Конфигурационные файлы
```
├── .env                                 # 🔐 Переменные окружения (секретные)
├── .env.example                         # 📝 Пример конфигурации
├── .env.postgres                        # 🗄️ Настройки PostgreSQL
├── .gitignore                           # 🚫 Исключения Git
└── .vscode/                             # ⚙️ Настройки VS Code
```

**НАЗНАЧЕНИЕ**: Управление проектом, автоматизация задач, конфигурация среды

---

## 📦 ИСХОДНЫЙ КОД (src/)

### 🏛️ Структура пакета
```
src/auto_reviews_parser/                  # Основной Python пакет
├── __init__.py                          # 📍 Инициализация пакета
├── config/                              # ⚙️ Конфигурация системы
├── models/                              # 🏗️ Модели данных (dataclasses)
├── database/                            # 🗄️ Работа с базами данных
├── catalog/                             # 📂 Инициализация каталогов
├── parsers/                             # 🕷️ Парсеры сайтов
├── services/                            # 🛠️ Бизнес-логика
├── analyzers/                           # 📈 Анализ данных
├── integration/                         # 🔗 Интеграции с внешними системами
└── utils/                               # 🔧 Вспомогательные утилиты
```

### 🕷️ Парсеры (src/auto_reviews_parser/parsers/)
```
├── unified_master_parser.py             # 🎯 МАСТЕР-ПАРСЕР (единый)
├── production_drom_parser.py            # 🏭 Производственный парсер
├── base_parser.py                       # 🏗️ Базовый класс парсеров
├── drom_parser.py                       # 🌐 Основной парсер Drom.ru
└── __init__.py                          # 📍 Экспорты парсеров
```

### 🗄️ База данных (src/auto_reviews_parser/database/)
```
├── repositories/                        # 📚 Репозитории данных
├── models/                              # 🏗️ ORM модели
├── migrations/                          # 🔄 Миграции схемы
└── connection.py                        # 🔌 Подключение к БД
```

**НАЗНАЧЕНИЕ**: Основной код системы, организованный в модули по функциональности

---

## 🔧 СКРИПТЫ (scripts/)

### 📁 Категории скриптов
```
scripts/
├── parsing/                             # 🕷️ Скрипты парсинга
├── database/                            # 🗄️ Скрипты работы с БД
├── setup/                               # 🔧 Скрипты настройки
├── testing/                             # 🧪 Скрипты тестирования
├── demo/                                # 🎬 Демонстрационные скрипты
├── analysis/                            # 📊 Скрипты анализа
├── maintenance/                         # 🛠️ Скрипты обслуживания
├── debugging/                           # 🐛 Скрипты отладки
└── migration/                           # 🔄 Скрипты миграции
```

### 🕷️ Скрипты парсинга (scripts/parsing/)
```
├── unified_russian_parser.py           # 🇷🇺 Унифицированный русский парсер
├── brand_catalog_extractor.py          # 📂 Извлечение каталога брендов
├── comprehensive_brand_parser.py       # 🏢 Комплексный парсер брендов
├── normalized_parser.py                # 📐 Нормализованный парсер
├── full_parsing_system.py              # 🌐 Полная система парсинга
└── ...                                 # 📚 Множество специализированных парсеров
```

### 🎯 Основные скрипты
```
├── main.py                              # 🎯 Главный скрипт запуска
├── run_system.py                        # 🚀 Запуск всей системы
├── full_parsing_demo.py                 # 🎬 Демо полного парсинга
└── full_parsing_production.py          # 🏭 Производственный парсинг
```

**НАЗНАЧЕНИЕ**: Готовые скрипты для выполнения конкретных задач, организованные по категориям

---

## 📊 ДАННЫЕ (data/)

### 🗂️ Структура данных
```
data/
├── brand_catalog.json                   # 📂 Каталог брендов
├── cache/                               # 💾 Кэш парсинга
├── databases/                           # 🗄️ Файлы баз данных
├── exports/                             # 📤 Экспорты данных
├── production_parsing_*.json            # 🏭 Результаты производственного парсинга
└── unified_parsing_results_*.json      # 🎯 Результаты унифицированного парсинга
```

**НАЗНАЧЕНИЕ**: Хранение всех данных проекта - от кэша до результатов парсинга

---

## 📚 ДОКУМЕНТАЦИЯ (docs/)

### 📖 Типы документации
```
docs/
├── КАК_ПОЛЬЗОВАТЬСЯ.md                  # 👤 Руководство пользователя (РУС)
├── НАЧАЛО_ПАРСИНГА.md                   # 🚀 Быстрый старт (РУС)
├── РУКОВОДСТВО_ПАРСИНГА.md              # 📋 Подробное руководство (РУС)
├── UNIFIED_PARSER_ARCHITECTURE.md      # 🏗️ Архитектура унифицированного парсера
├── DATABASE_NORMALIZATION_REPORT.md    # 🗄️ Отчет по нормализации БД
├── SYSTEM_STATUS_REPORT.md             # 📊 Отчет о состоянии системы
└── ...                                 # 📚 Множество технических документов
```

**НАЗНАЧЕНИЕ**: Полная техническая документация на русском и английском языках

---

## 🧪 ТЕСТИРОВАНИЕ (tests/)

### 🔬 Структура тестов
```
tests/
├── conftest.py                          # ⚙️ Конфигурация pytest
├── test_complete_system.py             # 🌐 Тесты всей системы
├── test_drom_parser.py                 # 🕷️ Тесты парсера Drom.ru
├── test_botasaurus.py                  # 🤖 Тесты Botasaurus
└── ...                                 # 🧪 Специализированные тесты
```

**НАЗНАЧЕНИЕ**: Автоматическое тестирование всех компонентов системы

---

## 🐳 РАЗВЕРТЫВАНИЕ (docker/)

### 📦 Контейнеризация
```
docker/
├── docker-compose.postgres.yml         # 🗄️ PostgreSQL контейнер
└── postgres/                           # 🐘 Конфигурация PostgreSQL
```

**НАЗНАЧЕНИЕ**: Контейнеризованное развертывание системы

---

## 📝 ЛОГИ (logs/)

### 📊 Система логирования
```
logs/
├── production_parser.log               # 🏭 Логи производственного парсера
├── unified_parser.log                  # 🎯 Логи унифицированного парсера
└── *.log                               # 📝 Логи различных компонентов
```

**НАЗНАЧЕНИЕ**: Журналирование работы всех компонентов системы

---

## 🎯 ФАЙЛЫ ЗАПУСКА (корневая папка)

### 🚀 Основные точки входа
```
├── run_unified_parser.py               # 🎯 Запуск унифицированного парсера
├── run_production_parser.py            # 🏭 Запуск производственного парсера
├── simple_menu.py                      # 🖱️ Интерактивное меню (566 строк)
├── quick_start.sh                      # ⚡ Скрипт быстрого запуска
└── cli/main.py                         # 💻 Командная строка (CLI)
```

### 💻 CLI интерфейс (cli/)
```
cli/
├── main.py                             # 🎯 Основной CLI интерфейс
├── init_db.py                          # 🗄️ Инициализация базы данных
└── main.py.tmp                         # 📝 Временный файл
```

**НАЗНАЧЕНИЕ**: Основные точки входа в систему для разных режимов работы

---

## 🔧 СЛУЖЕБНЫЕ ДИРЕКТОРИИ

### 🛠️ Инфраструктура
```
├── chrome-linux/                       # 🌐 Chromium для веб-парсинга
├── archive/                            # 📦 Архив старых парсеров (2 файла)
├── .pytest_cache/                      # 🧪 Кэш pytest
├── .venv/                              # 🐍 Виртуальное окружение Python
├── parser_env                          # 🐍 Альтернативное виртуальное окружение
├── .git/                               # 📚 Репозиторий Git
└── .github/                            # 🔧 GitHub Actions
```

### 📦 Архив (archive/)
```
archive/
├── catalog_initializer.py             # 📂 Старый инициализатор каталога
└── catalog_parser_v2.py               # 🕷️ Старая версия парсера каталога
```

**НАЗНАЧЕНИЕ**: Служебная инфраструктура проекта + архив устаревших версий

---

## 🏗️ НАЗНАЧЕНИЕ ДИРЕКТОРИЙ src/ и scripts/

### 📦 src/ - ОСНОВНОЙ КОД
**Философия**: Код как продукт
- ✅ **Стабильный API** - классы и функции с четкими интерфейсами
- ✅ **Переиспользуемый код** - модули можно импортировать в других проектах
- ✅ **Тестируемый** - покрыт автоматическими тестами
- ✅ **Документированный** - docstrings и типизация
- ✅ **Установка как пакет** - `pip install -e .`

### 🔧 scripts/ - ГОТОВЫЕ РЕШЕНИЯ  
**Философия**: Код как инструмент
- ✅ **Готовые к запуску** - можно запустить командой `python script.py`
- ✅ **Специализированные** - каждый скрипт решает конкретную задачу
- ✅ **Быстрое прототипирование** - для экспериментов и демонстраций
- ✅ **Адаптируемые** - легко модифицировать под новые задачи
- ✅ **Категоризированные** - организованы по типам задач

### 🔄 ВЗАИМОДЕЙСТВИЕ
```
scripts/ ИСПОЛЬЗУЕТ → src/
```
- Скрипты импортируют классы из src/
- src/ предоставляет стабильные API
- scripts/ комбинируют функциональность для конкретных задач

---

## 🎯 ПРИНЦИПЫ АРХИТЕКТУРЫ

### 1. 🏗️ **Разделение ответственности**
- `src/` = библиотечный код
- `scripts/` = исполняемые сценарии  
- `data/` = все данные
- `docs/` = документация
- `tests/` = тестирование

### 2. 🔄 **Единая точка правды**
- Один унифицированный парсер вместо множества
- Централизованная конфигурация
- Единая система логирования

### 3. 📈 **Масштабируемость**
- Модульная архитектура
- Кэширование на всех уровнях
- Асинхронная обработка

### 4. 🛡️ **Надежность**
- Полное покрытие тестами
- Обработка ошибок
- Логирование всех операций

### 5. 🔧 **Удобство использования**
- CLI интерфейс
- Интерактивное меню
- Make команды для автоматизации

---

## 📊 СТАТИСТИКА ПРОЕКТА

```
📁 Директорий: 25+
📄 Python файлов: 100+  
📚 Документов: 20+
🧪 Тестов: 15+
🔧 Скриптов: 50+
📦 Зависимостей: 15+
```

**ИТОГО**: Полнофункциональная система парсинга с промышленной архитектурой
